---
tags:
  - ê°œë°œ
  - ê¸°ìˆ ì •ë¦¬
  - "#ìŠ¤í”„ë§ë¹ˆ"
  - "#IoCì»¨í…Œì´ë„ˆ"
  - "#ComponentScan"
  - "#ë¹ˆë“±ë¡"
created: 2025-05-08
type: ê¸°ìˆ ì •ë¦¬
aliases:
  - ìŠ¤í”„ë§ IoC ì»¨í…Œì´ë„ˆ
  - ë¹ˆ ë“±ë¡ ë°©ë²•
  - "@Configurationê³¼ ì‹±ê¸€í†¤"
  - "@ComponentScan í™œìš©"
---

# ğŸ“˜ Spring Bean

Spring Bean ì€ IoC ê°€ ê´€ë¦¬í•˜ëŠ” ê°ì²´ë¥¼ ì˜ë¯¸í•˜ë©°, **ê°ì²´ì˜ ìƒì„±, ì˜ì¡´ì„± ê´€ë¦¬, ìƒëª…ì£¼ê¸° ë“±ì„ ê´€ë¦¬**í•œë‹¤.  
ìŠ¤í”„ë§ì—ì„œ Beanì„ ë“±ë¡í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

- `@Component` ë° ê·¸ í•˜ìœ„ ì–´ë…¸í…Œì´ì…˜(`@Service`, `@Repository`, `@Controller`) ì‚¬ìš©
- `@Configuration` í´ë˜ìŠ¤ì—ì„œ `@Bean` ë©”ì„œë“œ ì‚¬ìš©

ì•„ë˜ëŠ” `@Configuration`ì„ í™œìš©í•œ ì˜ˆì œì´ë‹¤.

```java
@Configuration  
public class AppConfig {  

    @Bean  
    public MemberService memberService(){  
        return new MemberServiceImpl(memberRepository());  
    }
  
    @Bean  
    public MemoryMemberRepository memberRepository() {  
        return new MemoryMemberRepository();  
    }
  
    @Bean  
    public OrderService orderService(){  
        return new OrderServiceImpl(memberRepository(), discountPolicy());  
    }
  
    @Bean  
    public DiscountPolicy discountPolicy() {  
        return new RateDisCountPolicy();  
    }
  
}
```

## `@Configuration`ê³¼ ì‹±ê¸€í†¤ íŒ¨í„´

ìŠ¤í”„ë§ì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì‹±ê¸€í†¤ íŒ¨í„´(Singleton Pattern)ì„ ì ìš©í•˜ì—¬ **Beanì„ í•œ ë²ˆë§Œ ìƒì„±**í•˜ê³ , ë™ì¼í•œ ê°ì²´ë¥¼ ì¬ì‚¬ìš©í•œë‹¤.  
ì´ë¥¼ ìœ„í•´ `@Configuration`ì„ í´ë˜ìŠ¤ì— ì„ ì–¸í•˜ë©´, ë‚´ë¶€ì ìœ¼ë¡œ **CGLIB í”„ë¡ì‹œ**ê°€ ìƒì„±ë˜ì–´ `@Bean` ë©”ì„œë“œê°€ ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œë˜ë”ë¼ë„ **ë™ì¼í•œ ì¸ìŠ¤í„´ìŠ¤**ë¥¼ ë°˜í™˜í•˜ë„ë¡ ë³´ì¥í•œë‹¤.

```java
ApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class);

MemberService memberService1 = context.getBean(MemberService.class);
MemberService memberService2 = context.getBean(MemberService.class);

System.out.println(memberService1 == memberService2); // true (ë™ì¼í•œ ê°ì²´)
```

### `@Configuration`ì„ ìƒëµí•˜ë©´?

ë§Œì•½ `@Configuration`ì„ ìƒëµí•˜ê³  `@Bean`ë§Œ ì‚¬ìš©í•˜ë©´ **ì‹±ê¸€í†¤ì´ ê¹¨ì§ˆ ê°€ëŠ¥ì„±ì´ ìˆë‹¤.**  
ì´ ê²½ìš° `@Bean` ë©”ì„œë“œê°€ í˜¸ì¶œë  ë•Œë§ˆë‹¤ ìƒˆë¡œìš´ ê°ì²´ê°€ ìƒì„±ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì£¼ì˜í•´ì•¼ í•œë‹¤.

## `@ComponentScan` ì„ ì‚¬ìš©í•œ ìë™ ë¹ˆ ë“±ë¡

ìŠ¤í”„ë§ì—ì„œëŠ” `@ComponentScan`ì„ ì‚¬ìš©í•˜ì—¬ **ìë™ìœ¼ë¡œ Beanì„ ë“±ë¡**í•  ìˆ˜ ìˆë‹¤.  
ëŒ€ê·œëª¨ í”„ë¡œì íŠ¸ì—ì„œëŠ” ëª¨ë“  Beanì„ ìˆ˜ë™ìœ¼ë¡œ ë“±ë¡í•˜ëŠ” ê²ƒì´ ì–´ë µê³  ë²ˆê±°ë¡œìš¸ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— `@ComponentScan`ì„ ì‚¬ìš©í•˜ë©´ íŠ¹ì • íŒ¨í‚¤ì§€ì™€ ê·¸ í•˜ìœ„ íŒ¨í‚¤ì§€ì— ìˆëŠ” `@Component`, `@Service`, `@Repository`, `@Controller` ì–´ë…¸í…Œì´ì…˜ì´ ë¶™ì€ í´ë˜ìŠ¤ë¥¼ ìë™ìœ¼ë¡œ ìŠ¤ìº”í•˜ì—¬ Beanìœ¼ë¡œ ë“±ë¡í•œë‹¤.

ë˜í•œ, **`@Autowired`ë¥¼ í™œìš©í•œ ìƒì„±ì ì£¼ì…**ì„ ì‚¬ìš©í•˜ë©´ **ë¶ˆë³€ì„±ì„ ë³´ì¥**í•˜ê³  **í…ŒìŠ¤íŠ¸ê°€ ìš©ì´í•´ì§€ëŠ” ì¥ì **ì´ ìˆë‹¤.

```java
@Repository
public class MemberRepository {
    public String getData() {
        return "Member Data";
    }
}
```

```java
@Service
public class MemberService {
    private final MemberRepository memberRepository;

    @Autowired
    public MemberService(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }

    public String getMemberInfo() {
        return memberRepository.getData();
    }
}
```

```java
@Configuration
@ComponentScan(basePackages = "com.example")
public class AppConfig {
}
```

> ğŸ’¡ `@SpringBootApplication`ì—ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ `@ComponentScan`ì´ í¬í•¨ë˜ì–´ ìˆìŒ.  
> íŠ¹ì • íŒ¨í‚¤ì§€ë§Œ ìŠ¤ìº”í•˜ê³  ì‹¶ì„ ê²½ìš° `basePackages` ì†ì„±ì„ ëª…ì‹œí•˜ë©´ ë¨.

```java
public class MainApp {
    public static void main(String[] args) {
        ApplicationContext context = new AnnotationConfigApplicationContext(com.example.config.AppConfig.class);
        MemberService memberService = context.getBean(MemberService.class);
        System.out.println(memberService.getMemberInfo()); // "Member Data"
    }
}
```

## ğŸ” Spring Bean ì¡°íšŒ ë°©ë²•

Spring IoC ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œëŠ” `Bean Name`ê³¼ `Class` í˜•íƒœë¡œ ê°ì²´ê°€ ë“±ë¡ëœë‹¤.

|ë¹ˆ ì´ë¦„ (Bean Name)|í´ë˜ìŠ¤ (Class)|
|---|---|
|userController|com.example.UserController|
|userService|com.example.UserServiceImpl|
|userMapper|com.example.UserMapper|
|emailUtil|com.example.EmailUtil|
|qrUtil|com.example.QrUtil|
|thymeleafConfig|com.example.ThymeleafConfig|
|dataSource|com.zaxxer.hikari.HikariDataSource|

### ì£¼ìš” ë©”ì„œë“œ

#### `getBean(String name)`

```java
MemberService memberService = (MemberService) context.getBean("memberService");
```

#### `getBean(String name, Class<T> requiredType)`

```java
MemberService memberService = context.getBean("memberService", MemberService.class);
```

#### `getBean(Class<T> requiredType)`

```java
MemberService memberService = context.getBean(MemberService.class);
```

#### `getBeansOfType(Object.class)`

```java
Map<String, Object> beans = context.getBeansOfType(Object.class);
```

---

## ğŸŒ€ Spring Bean ìƒëª…ì£¼ê¸° (Lifecycle)

Springì€ Beanì˜ ìƒëª…ì£¼ê¸°ë¥¼ ê´€ë¦¬í•˜ë©°, ë‹¤ìŒê³¼ ê°™ì€ ìˆœì„œë¡œ ë™ì‘í•œë‹¤:

1. ê°ì²´ ìƒì„±
2. ì˜ì¡´ê´€ê³„ ì£¼ì…
3. ì´ˆê¸°í™” ì½œë°± í˜¸ì¶œ
4. ì‚¬ìš©
5. ì†Œë©¸ ì „ ì½œë°± í˜¸ì¶œ

### âœ… ì´ˆê¸°í™” (Initialization)

- `@PostConstruct` (ê¶Œì¥)

```java
@PostConstruct
public void init() {
    // ì´ˆê¸°í™” ì‘ì—…
}
```

- `InitializingBean` ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„

```java
@Override
public void afterPropertiesSet() throws Exception {
    // ì´ˆê¸°í™” ì‘ì—…
}
```

- `@Bean(initMethod = "init")` ë°©ì‹

```java
@Bean(initMethod = "init")
public SomeService someService() {
    return new SomeService();
}
```

### âŒ ì†Œë©¸ (Destruction)

- `@PreDestroy` (ê¶Œì¥)

```java
@PreDestroy
public void close() {
    // ì •ë¦¬ ì‘ì—…
}
```

- `DisposableBean` ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„

```java
@Override
public void destroy() throws Exception {
    // ì •ë¦¬ ì‘ì—…
}
```

- `@Bean(destroyMethod = "close")` ë°©ì‹

```java
@Bean(destroyMethod = "close")
public SomeService someService() {
    return new SomeService();
}
```

> ğŸ’¡ `@PostConstruct` / `@PreDestroy`ëŠ” JSR-250 í‘œì¤€ì´ë©°, Spring Boot 3.xë¶€í„°ëŠ” `jakarta.annotation` íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•¨ì— ìœ ì˜í•  ê²ƒ.
